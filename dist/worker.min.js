/**
* @module cors
* @author nuintun
* @license MIT
* @version 0.0.1
* @description A pure JavaScript CORS framework.
* @see https://nuintun.github.io/cors
*/
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define("cors-worker",n):t.CORSWorker=n()}(this,function(){"use strict";function t(t,n){return o+n+"-"+t+r}function n(n,e,i){return t(n,i)+e+a}function e(t,n,e){return t=d+"-"+e+"-"+t,"function"==typeof n&&(window.navigator[t]=n),window.navigator[t]}function i(t,n,e){this.name=String(t),this.namespace=e,this.target=n}function s(t,n){this.name=String(t),this.namespace=arguments.length>1?String(n):"Messenger",this.targets={},this.listens=[],this.init()}var o="",r="",a="",d="",f="postMessage"in window,c="attachEvent"in window,u="addEventListener"in window;return i.prototype.send=f?function(t){this.target.postMessage(n(this.name,t,this.namespace),"*")}:function(t){var i=e(this.name,this.namespace);if("function"!=typeof i)throw new Error("Target callback function is not defined");i(n(t),window)},s.prototype.init=function(){function n(n){if("object"==typeof n&&n.data&&(n=n.data),function(n,e,i){return 0===e.indexOf(t(n,i))&&e.lastIndexOf(a)===e.length-1}(i,n,s)){n=function(n,e,i){return e.slice(t(n,i).length,-1)}(i,n,s);for(var e=0,r=o.length;e<r;e++)o[e](n)}}var i=this.name,s=this.namespace,o=this.listens;f?u?window.addEventListener("message",n,!1):c&&window.attachEvent("onmessage",n):e(i,n,s)},s.prototype.add=function(t,n){this.targets[t]=new i(t,n,this.namespace)},s.prototype.listen=function(t){this.listens.push(t)},s.prototype.clear=function(){this.listens=[]},s.prototype.send=function(t,n){var e=this.targets;if(arguments.length>1)n=String(n),e.hasOwnProperty(n)&&e[n].send(t);else for(var i in e)e.hasOwnProperty(i)&&e[i].send(t)},function(){var t=new s("Worker");t.add("Master",window.parent),t.listen(function(n){n=JSON.parse(n),t.send(JSON.stringify({valid:!0,uid:n.uid,data:{username:"nuintun"}}),"Master")}),t.send("ready","Master")}});
//# sourceMappingURL=worker.js.map