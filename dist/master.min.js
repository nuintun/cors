/**
* @module cors
* @author nuintun
* @license MIT
* @version 0.0.1
* @description A pure JavaScript CORS framework.
* @see https://nuintun.github.io/cors
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("cors-master",e):t.CORSMaster=e()}(this,function(){"use strict";function t(t,e){return o+e+"-"+t+a}function e(e,n,i){return t(e,i)+n+c}function n(t,e,n){return t=d+"-"+n+"-"+t,"function"==typeof e&&(window.navigator[t]=e),window.navigator[t]}function i(t,e,n){this.name=String(t),this.namespace=n,this.target=e}function s(t,e){this.name=String(t),this.namespace=arguments.length>1?String(e):"Messenger",this.targets={},this.listens=[],this.init()}function r(t){this["<ready>"]=!1,this.messenger=this.proxy(t)}var o="",a="",c="",d="",u="postMessage"in window,f="attachEvent"in window,h="addEventListener"in window;return i.prototype.send=u?function(t){this.target.postMessage(e(this.name,t,this.namespace),"*")}:function(t){var i=n(this.name,this.namespace);if("function"!=typeof i)throw new Error("Target callback function is not defined");i(e(t),window)},s.prototype.init=function(){function e(e){if("object"==typeof e&&e.data&&(e=e.data),function(e,n,i){return 0===n.indexOf(t(e,i))&&n.lastIndexOf(c)===n.length-1}(i,e,s)){e=function(e,n,i){return n.slice(t(e,i).length,-1)}(i,e,s);for(var n=0,o=r.length;n<o;n++)r[n](e)}}var i=this.name,s=this.namespace,r=this.listens;u?h?window.addEventListener("message",e,!1):f&&window.attachEvent("onmessage",e):n(i,e,s)},s.prototype.add=function(t,e){this.targets[t]=new i(t,e,this.namespace)},s.prototype.listen=function(t){this.listens.push(t)},s.prototype.clear=function(){this.listens=[]},s.prototype.send=function(t,e){var n=this.targets;if(arguments.length>1)e=String(e),n.hasOwnProperty(e)&&n[e].send(t);else for(var i in n)n.hasOwnProperty(i)&&n[i].send(t)},r.prototype={ready:function(t){},proxy:function(t){var e=document.createElement("iframe");e.setAttribute("width","0"),e.setAttribute("height","0"),e.setAttribute("frameborder","0"),e.setAttribute("marginwidth","0"),e.setAttribute("marginheight","0"),e.src=t,document.documentElement.appendChild(e);var n=new s("master");return n.add("worker",e.contentWindow),n.listen(function(t){console.log(t),n.send("Master received","worker")}),n},request:function(t){}},r});
//# sourceMappingURL=master.js.map